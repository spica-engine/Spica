<div class="dashboard-container">
  <div *ngIf="dashboard$ | async; let dashboard">
    <mat-toolbar>
      <h1>
        <mat-icon> {{ dashboard.icon }} </mat-icon>
        <span> {{ dashboard.name }}</span>
      </h1>
      <button
        mat-button
        (click)="
          componentStyles = getDefaultComponentStyles(dashboard.components.length);
          saveComponentStyles()
        "
      >
        <mat-icon>
          restart_alt
        </mat-icon>
        Reset
      </button>
    </mat-toolbar>
    <div class="components-container">
      <mat-card
        *ngFor="let component of dashboard.components; index as i"
        class="card"
        [ngStyle]="componentStyles[i]"
        (mouseup)="onEditEnded($event.currentTarget, i)"
        cdkDrag
        cdkDragBoundary=".components-container"
      >
        <div class="drag-cursor" cdkDragHandle></div>
        <dashboard-default
          *ngIf="defaultTypes.indexOf(component.type) != -1"
          [componentData$]="componentData$[i]"
          [type]="component.type"
          (onUpdate)="onUpdate($event, i)"
        >
        </dashboard-default>
        <dashboard-table
          *ngIf="component.type == 'table'"
          [componentData$]="componentData$[i]"
          [type]="component.type"
          (onUpdate)="onUpdate($event, i)"
        >
        </dashboard-table>
        <dashboard-card
          *ngIf="component.type == 'card'"
          [componentData$]="componentData$[i]"
          [type]="component.type"
          (onUpdate)="onUpdate($event, i)"
        >
        </dashboard-card>
      </mat-card>
    </div>
  </div>
</div>
