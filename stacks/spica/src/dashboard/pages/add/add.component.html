<mat-toolbar>
  <h4 class="mat-h4">
    <button
      mat-icon-button
      menu-icon
      class="mat-elevation-z25"
      matTooltip="You can select a icon by clicking here."
      [matMenuTriggerFor]="iconSelector"
    >
      <mat-icon>{{ dashboard.icon }}</mat-icon>
      <mat-menu #iconSelector="matMenu">
        <ng-container matMenuContent>
          <button
            *ngFor="let icon of visibleIcons"
            mat-icon-button
            mat-flat-button
            [matTooltip]="icon"
            (click)="dashboard.icon = icon"
          >
            <mat-icon>{{ icon }}</mat-icon>
          </button>
          <mat-paginator
            (page)="
              this.visibleIcons = this.icons.slice(
                $event.pageIndex * $event.pageSize,
                ($event.pageIndex + 1) * $event.pageSize
              )
            "
            (click)="$event.stopPropagation()"
            [length]="icons.length"
            [pageSize]="iconPageSize"
          >
          </mat-paginator>
        </ng-container>
      </mat-menu>
    </button>
    <span>{{ dashboard._id ? "Edit dashboard" : "New dashboard" }}</span>
  </h4>
</mat-toolbar>
<mat-card class="mat-elevation-z25">
  <mat-card-content>
    <form #form="ngForm">
      <mat-list>
        <mat-list-item>
          <mat-form-field>
            <mat-label>
              Name
            </mat-label>
            <input matInput placeholder="Name" name="name" [(ngModel)]="dashboard.name" required />
          </mat-form-field>
        </mat-list-item>
        <h4>Components</h4>
        <mat-list-item class="component" *ngFor="let component of dashboard.components; index as i">
          <div class="container">
            <mat-form-field>
              <mat-label>
                Name
              </mat-label>
              <input
                matInput
                placeholder="Name"
                [name]="i + '.name'"
                [(ngModel)]="component.name"
                required
              />
            </mat-form-field>
            <mat-form-field>
              <mat-label>
                Url
              </mat-label>
              <input
                matInput
                placeholder="Url"
                [name]="i + '.url'"
                [(ngModel)]="component.url"
                required
              />
            </mat-form-field>
            <mat-form-field>
              <mat-label>
                Type
              </mat-label>
              <mat-select [name]="i + '.type'" [(ngModel)]="component.type">
                <mat-option class="mat-accent" value="bar">
                  Bar
                </mat-option>
                <mat-option class="mat-accent" value="line">
                  Line
                </mat-option>
                <mat-option class="mat-accent" value="table">
                  Table
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="delete-button-container">
            <button mat-icon-button color="warn" (click)="dashboard.components.splice(i, 1)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
        </mat-list-item>
        <button type="button" mat-button class="new-component" (click)="addComponent()">
          <mat-icon>add</mat-icon>Add New Component
        </button>
      </mat-list>
    </form>
  </mat-card-content>
  <mat-card-actions>
    <button class="save-button" mat-button (click)="save()">
      <mat-icon>save</mat-icon>
      Save
    </button>
  </mat-card-actions>
</mat-card>
